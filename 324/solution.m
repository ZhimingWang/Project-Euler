#!/usr/bin/env wolframscript
mod = 100000007;

gf[x] = (x^18 - 446 x^17 + 36701 x^16 - 1267416 x^15 + 
     22828288 x^14 - 235207768 x^13 + 1443564488 x^12 - 
     5338083112 x^11 + 11818867674 x^10 - 15460884436 x^9 + 
     11818867674 x^8 - 5338083112 x^7 + 1443564488 x^6 - 
     235207768 x^5 + 22828288 x^4 - 1267416 x^3 + 36701 x^2 - 446 x + 
     1)/(-x^19 + 675 x^18 - 73471 x^17 + 3221189 x^16 - 
     72583272 x^15 + 925908264 x^14 - 6971103216 x^13 + 
     31523058272 x^12 - 86171526770 x^11 + 142604534086 x^10 - 
     142604534086 x^9 + 86171526770 x^8 - 31523058272 x^7 + 
     6971103216 x^6 - 925908264 x^5 + 72583272 x^4 - 3221189 x^3 + 
     73471 x^2 - 675 x + 1);
v = Table[Mod[SeriesCoefficient[gf[x], {x, 0, i}], mod], {i, 0, 22}];

coeffs = {1, -679, 76177, -3519127, 85911555, -1235863045, 
   11123194131, -65256474997, 257866595482, -705239311926, 
   1363115167354, -1888426032982, 1888426032982, -1363115167354, 
   705239311926, -257866595482, 65256474997, -11123194131, 
   1235863045, -85911555, 3519127, -76177, 679};
t = SparseArray[Table[{i + 1, i} -> 1, {i, 22}]~Join~
     Table[{i, 23} -> Mod[coeffs[[i]], mod], {i, 23}]] // Normal;

f[n_] := Mod[First[v.Algebra`MatrixPowerMod[t, n/2, mod]], mod];
Print[f[10^10000]];
